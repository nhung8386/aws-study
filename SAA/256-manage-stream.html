<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Amazon MSK - Managed Streaming for Apache Kafka</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #0ea5e9; /* Sky 500 - Streaming/Flow */
            --secondary-color: #f97316; /* Orange 500 - Analytics/Focus */
            --background-color: #f0f9ff; /* Sky 50 */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: #1f2937;
        }
        .header-bg {
            background-color: var(--primary-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        .card {
            background-color: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--primary-color);
        }
        .concept-box {
            border: 2px dashed var(--secondary-color);
            background-color: #fff7ed; /* Orange 50 */
        }
        b {
            font-weight: 700 !important;
            color: var(--primary-color);
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header & Language Toggle -->
    <header class="header-bg py-4 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <h1 id="introTitle" class="text-2xl sm:text-3xl font-extrabold text-white tracking-tight flex items-center">
                <i class="fas fa-stream mr-3"></i> Amazon MSK
            </h1>
            <div class="flex space-x-2 bg-white/20 rounded-full p-1">
                <button id="langToggleVi" class="px-3 py-1 rounded-full font-semibold text-sm transition text-white hover:bg-white/30"></button>
                <button id="langToggleEn" class="px-3 py-1 rounded-full font-semibold text-sm transition text-white hover:bg-white/30"></button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-12">

        <!-- Section 1: Introduction & Features -->
        <section class="card space-y-4">
            <h2 id="section1Title" class="text-3xl font-extrabold text-gray-800 border-b pb-2 mb-4"></h2>
            
            <p id="section1Intro" class="text-lg text-gray-700"></p>
            
            <h3 id="featuresTitle" class="text-2xl font-bold text-primary-color pt-4 border-t border-gray-100"></h3>
            <ul id="featuresList" class="list-disc ml-6 space-y-2 text-gray-700 leading-relaxed">
                <!-- Features populated by JS -->
            </ul>
            <p id="setupEase" class="p-3 mt-4 bg-green-50 rounded-lg border border-green-200 text-green-800 font-medium"></p>
        </section>

        <!-- Section 2: MSK Serverless & Kafka Architecture -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="card concept-box">
                <h3 id="serverlessTitle" class="text-2xl font-bold text-secondary-color mb-3 flex items-center"><i class="fas fa-cloud mr-3"></i> </h3>
                <p id="serverlessDesc" class="text-gray-700 leading-relaxed"></p>
            </div>
            
            <div class="card">
                <h3 id="kafkaConceptTitle" class="text-2xl font-bold text-primary-color mb-4 flex items-center"><i class="fas fa-network-wired mr-3"></i> </h3>
                <p id="kafkaConceptDesc" class="text-gray-700 leading-relaxed"></p>
                <p id="kafkaFlow" class="mt-3 text-sm text-gray-600 border-l-4 pl-3 border-secondary-color"></p>
            </div>
        </section>
        

        <!-- Section 3: Kafka vs. Kinesis Comparison -->
        <section>
            <h2 id="comparisonTitle" class="text-3xl font-extrabold text-gray-800 mb-6 text-center"></h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-6 concept-box rounded-xl">
                <!-- MSK Column -->
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-primary-color">
                    <h3 id="mskColTitle" class="text-xl font-bold text-primary-color mb-4 flex items-center"><i class="fab fa-aws mr-2"></i> Amazon MSK</h3>
                    <ul id="mskComparisonList" class="list-disc ml-6 space-y-3 text-gray-700">
                        <!-- MSK specific points -->
                    </ul>
                </div>
                <!-- Kinesis Column -->
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary-color">
                    <h3 id="kinesisColTitle" class="text-xl font-bold text-secondary-color mb-4 flex items-center"><i class="fas fa-bolt mr-2"></i> Kinesis Data Streams</h3>
                    <ul id="kinesisComparisonList" class="list-disc ml-6 space-y-3 text-gray-700">
                        <!-- Kinesis specific points -->
                    </ul>
                </div>
            </div>
        </section>
        [Image comparing Amazon Kinesis Data Streams and Amazon MSK architecture]

        <!-- Section 4: Consumption Options -->
        <section class="card border-l-secondary-color">
            <h2 id="consumptionTitle" class="text-3xl font-extrabold text-secondary-color mb-4 flex items-center"><i class="fas fa-hands-receiving mr-3"></i> </h2>
            <p id="consumptionIntro" class="text-lg text-gray-700 mb-6"></p>
            <div id="consumptionOptions" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Consumption options populated by JS -->
            </div>
        </section>
        
        <!-- Section 5: Key Takeaways -->
        <section class="p-8 bg-gray-800 rounded-2xl shadow-2xl text-white">
            <h2 id="takeawaysTitle" class="text-3xl font-extrabold mb-6 text-center text-primary-color"><i class="fas fa-key mr-2"></i> </h2>
            <ul id="takeawaysList" class="space-y-4">
                <!-- Takeaways populated by JS -->
            </ul>
            <p id="examReady" class="mt-8 text-center text-gray-400 font-semibold italic"></p>
        </section>

    </main>

    <script>
        const content = {
            'vi': {
                pageTitle: 'Amazon MSK - Managed Streaming for Apache Kafka',
                section1Title: 'Giới Thiệu Amazon MSK',
                section1Intro: 'Amazon Managed Streaming for Apache Kafka (Amazon MSK) là một dịch vụ phân tích dữ liệu luồng được cung cấp bởi AWS. Kafka là một giải pháp thay thế cho Amazon Kinesis, và cả hai đều cho phép <b>streaming dữ liệu</b>.',
                
                featuresTitle: 'Tính Năng Nổi Bật',
                features: [
                    'Cung cấp cluster Kafka được <b>quản lý hoàn toàn</b> (fully managed) trên AWS.',
                    'MSK quản lý các <b>Kafka broker nodes</b> và <b>Zookeeper broker nodes</b>.',
                    'Triển khai trong VPC qua nhiều Availability Zones (tối đa 3) cho <b>tính sẵn sàng cao (high availability)</b>.',
                    'Tự động khôi phục từ các lỗi Kafka phổ biến.',
                    'Dữ liệu được lưu trữ trên <b>EBS volumes</b> theo thời gian yêu cầu.'
                ],
                setupEase: 'Việc thiết lập Apache Kafka có thể khó khăn, nhưng với Amazon MSK, bạn có thể triển khai Kafka trên AWS chỉ với <b>một cú nhấp chuột</b>.',

                serverlessTitle: 'MSK Serverless',
                serverlessDesc: '<b>MSK Serverless</b> cho phép bạn chạy Apache Kafka trên MSK mà không cần phải cấp phát máy chủ hay quản lý dung lượng. MSK sẽ tự động cấp phát tài nguyên và <b>tự động mở rộng</b> compute và storage khi cần.',
                
                kafkaConceptTitle: 'Hiểu Về Apache Kafka',
                kafkaConceptDesc: 'Apache Kafka là một nền tảng cho việc <b>streaming dữ liệu</b>. Một cluster Kafka bao gồm nhiều brokers. Producers gửi dữ liệu đến một <b>Kafka topic</b>, được sao chép đầy đủ trên các brokers khác.',
                kafkaFlow: 'Consumers kéo dữ liệu từ các topics này để xử lý hoặc gửi đến các đích đến như EMR, S3, SageMaker, Kinesis, hoặc RDS.',

                comparisonTitle: 'So Sánh: Kafka vs. Kinesis Data Streams',
                mskColTitle: 'Amazon MSK (Topics & Partitions)',
                kinesisColTitle: 'Kinesis Data Streams (Streams & Shards)',
                mskComparisonList: [
                    'Giới hạn tin nhắn mặc định là 1 MB, có thể cấu hình lên <b>10 MB</b>.',
                    'Sử dụng <b>Kafka Topics</b> với <b>Partitions</b>.',
                    'Chỉ có thể <b>thêm Partitions</b> để mở rộng (Partitions không thể bị loại bỏ).',
                    'Hỗ trợ mã hóa trong quá trình truyền (in-flight encryption) bằng Plain text hoặc <b>TLS</b>.',
                    'Có thể giữ lại dữ liệu <b>lâu tùy ý</b> (hơn một năm), miễn là bạn trả phí cho EBS storage.'
                ],
                kinesisComparisonList: [
                    'Giới hạn tin nhắn là <b>1 MB</b>.',
                    'Sử dụng <b>Data Streams</b> với <b>Shards</b>.',
                    'Để mở rộng, thực hiện <b>Shard Splitting</b> hoặc <b>Merging</b>.',
                    'Cung cấp mã hóa trong quá trình truyền (in-flight encryption).',
                    'Thời gian giữ lại dữ liệu giới hạn.'
                ],
                
                consumptionTitle: 'Sản Xuất và Tiêu Thụ Dữ Liệu Với MSK',
                consumptionIntro: 'Để sản xuất (produce) dữ liệu cho MSK, bạn cần tạo một <b>Kafka Producer</b>. Để tiêu thụ (consume) dữ liệu từ MSK, có nhiều tùy chọn:',
                consumptionOptions: [
                    { title: 'Kinesis Data Analytics (Flink)', icon: 'fas fa-chart-bar', desc: 'Đọc trực tiếp từ MSK cluster để thực hiện phân tích luồng.' },
                    { title: 'AWS Glue (Spark Streaming)', icon: 'fas fa-wrench', desc: 'Thực hiện các job ETL streaming.' },
                    { title: 'Lambda Functions', icon: 'fas fa-server', desc: 'Sử dụng Amazon MSK làm <b>event source</b> để xử lý dữ liệu.' },
                    { title: 'Custom Kafka Consumer', icon: 'fas fa-code', desc: 'Viết consumer của riêng bạn và chạy trên EC2, ECS, hoặc EKS.' }
                ],
                
                takeawaysTitle: 'Các Điểm Chính Cần Nắm Vững',
                takeaways: [
                    '<b>Amazon MSK</b> cung cấp một cluster Apache Kafka được <b>quản lý hoàn toàn</b> trên AWS, đơn giản hóa việc triển khai.',
                    '<b>MSK Serverless</b> cho phép chạy Kafka mà không cần cấp phát máy chủ, với tính năng <b>tự động mở rộng</b> compute và storage.',
                    'Kafka và Kinesis là các giải pháp streaming, nhưng khác nhau về việc mở rộng, giới hạn tin nhắn, và quản lý partitions.',
                    'Dữ liệu có thể được sản xuất (produce) bằng <b>Kafka Producers</b> và tiêu thụ (consume) bằng các dịch vụ AWS hoặc custom consumers.'
                ],
                examReady: 'Khi bạn hiểu những khái niệm này, bạn đã sẵn sàng cho Amazon MSK ở cấp độ bài thi.'
            },
            'en': {
                pageTitle: 'Amazon MSK - Managed Streaming for Apache Kafka',
                section1Title: 'Introduction to Amazon MSK',
                section1Intro: 'Amazon Managed Streaming for Apache Kafka, also known as Amazon MSK, is an analytics service provided by AWS. Kafka is an alternative to Amazon Kinesis, and both allow for <b>data streaming</b>.',
                
                featuresTitle: 'Features of Amazon MSK',
                features: [
                    'Obtain a <b>fully managed Kafka cluster</b> on AWS.',
                    'MSK manages <b>Kafka broker nodes</b> and <b>Zookeeper broker nodes</b> within your cluster.',
                    'Deploy the cluster in your VPC across multiple Availability Zones (up to three) for <b>high availability</b>.',
                    'Provides automatic recovery from common Kafka failures.',
                    'Data is stored on <b>EBS volumes</b> for as long as required.'
                ],
                setupEase: 'Setting up Apache Kafka can be challenging, but with Amazon MSK, it is possible to deploy Kafka on AWS with a <b>single click</b>.',

                serverlessTitle: 'MSK Serverless',
                serverlessDesc: '<b>MSK Serverless</b> allows you to run Apache Kafka on MSK without provisioning servers or managing capacity. MSK automatically provisions resources and <b>scales compute and storage</b> as needed.',
                
                kafkaConceptTitle: 'Understanding Apache Kafka',
                kafkaConceptDesc: 'Apache Kafka is a platform for <b>streaming data</b>. A Kafka cluster consists of multiple brokers. Producers ingest data and send it to a <b>Kafka topic</b>, which is fully replicated across other brokers.',
                kafkaFlow: 'Consumers pull data from these topics to process or send to destinations such as EMR, S3, SageMaker, Kinesis, or RDS.',

                comparisonTitle: 'Comparison: Kafka vs. Kinesis Data Streams',
                mskColTitle: 'Amazon MSK (Topics & Partitions)',
                kinesisColTitle: 'Kinesis Data Streams (Streams & Shards)',
                mskComparisonList: [
                    'Default 1 MB message limit, configurable for up to <b>10 MB</b> message retention.',
                    'Uses <b>Kafka Topics</b> with <b>Partitions</b>.',
                    'You can only <b>add partitions</b> to scale a topic (partitions cannot be removed).',
                    'Offers in-flight encryption using Plain text or <b>TLS</b>.',
                    'Can retain data for <b>as long as you want</b> (over a year), paying for the underlying EBS storage.'
                ],
                kinesisComparisonList: [
                    'Has a <b>1 MB</b> message limit.',
                    'Uses <b>Data Streams</b> with <b>Shards</b>.',
                    'To scale, perform <b>Shard Splitting</b> or <b>Merging</b>.',
                    'Provides in-flight encryption.',
                    'Data retention is limited.'
                ],
                
                consumptionTitle: 'Producing and Consuming Data with MSK',
                consumptionIntro: 'To produce data to MSK, you need to create a <b>Kafka Producer</b>. To consume data from MSK, there are several options:',
                consumptionOptions: [
                    { title: 'Kinesis Data Analytics (Flink)', icon: 'fas fa-chart-bar', desc: 'Read directly from the MSK cluster to perform streaming analytics.' },
                    { title: 'AWS Glue (Spark Streaming)', icon: 'fas fa-wrench', desc: 'Perform streaming ETL jobs.' },
                    { title: 'Lambda Functions', icon: 'fas fa-server', desc: 'Use Amazon MSK as an <b>event source</b> to process data.' },
                    { title: 'Custom Kafka Consumer', icon: 'fas fa-code', desc: 'Write your own consumer and run it on EC2, ECS, or EKS.' }
                ],

                takeawaysTitle: 'Key Takeaways',
                takeaways: [
                    '<b>Amazon MSK</b> provides a <b>fully managed Apache Kafka cluster</b> on AWS, simplifying deployment and management.',
                    '<b>MSK Serverless</b> allows running Kafka without provisioning servers, with <b>automatic scaling</b> of compute and storage.',
                    'Kafka and Kinesis are both streaming solutions, but differ in scaling, message limits, and partition management.',
                    'Data can be produced using <b>Kafka Producers</b> and consumed using various AWS services or custom consumers.'
                ],
                examReady: 'Once you understand these concepts, you are well-prepared for Amazon MSK at the exam level.'
            }
        };

        let currentLang = 'vi';

        function renderContent() {
            const data = content[currentLang];
            document.title = data.pageTitle;
            document.documentElement.lang = currentLang;

            // Header & Language Toggle
            document.getElementById('introTitle').innerHTML = `<i class="fas fa-stream mr-3"></i> ${data.section1Title.split(' - ')[0]}`;
            document.getElementById('langToggleVi').textContent = 'VI';
            document.getElementById('langToggleEn').textContent = 'EN';
            
            // Section 1: Intro & Features
            document.getElementById('section1Title').textContent = data.section1Title;
            document.getElementById('section1Intro').innerHTML = data.section1Intro;
            
            document.getElementById('featuresTitle').textContent = data.featuresTitle;
            const featuresList = document.getElementById('featuresList');
            featuresList.innerHTML = data.features.map(f => `<li>${f}</li>`).join('');
            document.getElementById('setupEase').innerHTML = data.setupEase;

            // Section 2: Serverless & Kafka
            document.getElementById('serverlessTitle').innerHTML = `<i class="fas fa-cloud mr-3"></i> ${data.serverlessTitle}`;
            document.getElementById('serverlessDesc').innerHTML = data.serverlessDesc;
            document.getElementById('kafkaConceptTitle').innerHTML = `<i class="fas fa-network-wired mr-3"></i> ${data.kafkaConceptTitle}`;
            document.getElementById('kafkaConceptDesc').innerHTML = data.kafkaConceptDesc;
            document.getElementById('kafkaFlow').innerHTML = data.kafkaFlow;

            // Section 3: Comparison
            document.getElementById('comparisonTitle').textContent = data.comparisonTitle;
            document.getElementById('mskColTitle').innerHTML = `<i class="fab fa-aws mr-2"></i> ${data.mskColTitle}`;
            document.getElementById('kinesisColTitle').innerHTML = `<i class="fas fa-bolt mr-2"></i> ${data.kinesisColTitle}`;
            
            const mskList = document.getElementById('mskComparisonList');
            mskList.innerHTML = data.mskComparisonList.map(item => `<li>${item}</li>`).join('');

            const kinesisList = document.getElementById('kinesisComparisonList');
            kinesisList.innerHTML = data.kinesisComparisonList.map(item => `<li>${item}</li>`).join('');


            // Section 4: Consumption
            document.getElementById('consumptionTitle').innerHTML = `<i class="fas fa-hands-receiving mr-3"></i> ${data.consumptionTitle}`;
            document.getElementById('consumptionIntro').innerHTML = data.consumptionIntro;
            
            const consumptionOptions = document.getElementById('consumptionOptions');
            consumptionOptions.innerHTML = data.consumptionOptions.map(opt => `
                <div class="p-4 bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="text-xl font-bold text-secondary-color mb-1 flex items-center">
                        <i class="${opt.icon} mr-2"></i> ${opt.title}
                    </div>
                    <p class="text-sm text-gray-600">${opt.desc}</p>
                </div>
            `).join('');

            // Section 5: Key Takeaways
            document.getElementById('takeawaysTitle').innerHTML = `<i class="fas fa-key mr-2"></i> ${data.takeawaysTitle}`;
            const takeawaysList = document.getElementById('takeawaysList');
            takeawaysList.innerHTML = data.takeaways.map(tk => `
                <li class="flex items-start">
                    <i class="fas fa-check-circle text-primary-color mt-1 mr-3 flex-shrink-0"></i>
                    <span>${tk}</span>
                </li>
            `).join('');
            document.getElementById('examReady').textContent = data.examReady;
            
            // Update buttons
            const btnVi = document.getElementById('langToggleVi');
            const btnEn = document.getElementById('langToggleEn');
            const activeClass = 'bg-white text-primary-color';
            const inactiveClass = 'text-white hover:bg-white/30';
            
            btnVi.className = `px-3 py-1 rounded-full font-semibold text-sm transition ${currentLang === 'vi' ? activeClass : inactiveClass}`;
            btnEn.className = `px-3 py-1 rounded-full font-semibold text-sm transition ${currentLang === 'en' ? activeClass : inactiveClass}`;
        }

        document.getElementById('langToggleVi').addEventListener('click', () => {
            currentLang = 'vi';
            renderContent();
        });
        document.getElementById('langToggleEn').addEventListener('click', () => {
            currentLang = 'en';
            renderContent();
        });

        // Init
        document.addEventListener('DOMContentLoaded', renderContent);
    </script>
</body>
</html>